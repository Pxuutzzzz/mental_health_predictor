# Nixpacks Configuration for Mental Health Predictor
# Specifies both PHP (for Web UI) and Python (for ML Model)

# We use manual configuration to ensure both languages are present
providers = []

[phases.setup]
# Use generic 'php' package which guarantees 'php' binary availability
nixPkgs = [
    "php",
    "phpExtensions.pdo",
    "phpExtensions.pdo_mysql",
    "phpExtensions.mbstring",
    "phpPackages.composer",
    "python3",
    "python311Packages.pip"
]

[phases.install]
cmds = [
    "python -m venv /opt/venv && . /opt/venv/bin/activate && pip install -r requirements.txt",
    "cd laravel_web && composer install --no-dev --optimize-autoloader"
]

[start]
cmd = ". /opt/venv/bin/activate && php -S 0.0.0.0:$PORT -t laravel_web laravel_web/router.php"
