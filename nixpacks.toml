# Nixpacks Configuration for Mental Health Predictor
# Specifies both PHP (for Web UI) and Python (for ML Model)

providers = []

[phases.setup]
# Use APT (Debian) packages
aptPkgs = [
    "php-cli",
    "php-common",
    "php-mysql",
    "php-mbstring",
    "php-curl", 
    "python3",
    "python3-pip",
    "git",
    "unzip",
    "curl"
]

[phases.install]
cmds = [
    # Install Composer manually 
    "curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer",
    
    # Install Python dependencies GLOBALLY (System-wide)
    "pip3 install -r requirements.txt --break-system-packages",
    
    # Install PHP dependencies (Now in ROOT, not laravel_web)
    "composer install --no-dev --optimize-autoloader"
]

[start]
# Run PHP directly. Files are in ROOT now.
cmd = "/usr/bin/php -S 0.0.0.0:$PORT router.php"
